import{b as N}from"./books-CeArM665.js";import{_,o as l,c as a,a as t,b as u,t as g,F as f,r as b,d as B,e as S,w as k,f as T,v as P,n as F,g as z,h as C,i as A}from"./index-CjqUyn2e.js";const j={props:{resetCallback:{type:Function,required:!0}},methods:{resetFilters(){this.resetCallback()}}},I={class:"relative flex group mt-2"};function M(r,e,n,p,s,i){return l(),a("div",I,[t("button",{onClick:e[0]||(e[0]=(...d)=>i.resetFilters&&i.resetFilters(...d)),class:"float-end flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-red-900 bg-gray-100 border border-gray-300 rounded-lg hover:bg-red-200 focus:ring-2 focus:ring-red-500 focus:outline-none dark:bg-red-800 dark:border-red-700 dark:text-white dark:hover:bg-red-700 dark:focus:ring-red-400"}," Réinitialiser les filtres ")])}const V=_(j,[["render",M],["__scopeId","data-v-e6d013d4"]]),q={props:{sections:{type:Array,required:!0},selectedSection:{type:String,required:!1}},data(){return{isOpen:!1}},methods:{toggleDropdown(){this.isOpen=!this.isOpen},selectSection(r){this.$emit("update:selectedSection",r),this.isOpen=!1}}},Q={class:"relative inline-flex group"},R={key:0,class:"absolute mt-[2ch] bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-neutral-800 dark:divide-neutral-700"},U={class:"py-2 text-sm text-gray-700 dark:text-neutral-400"},W=["onClick"];function E(r,e,n,p,s,i){return l(),a("div",Q,[t("button",{onClick:e[0]||(e[0]=(...d)=>i.toggleDropdown&&i.toggleDropdown(...d)),class:"flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-gray-900 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700"},[u(g(n.selectedSection||"Toutes les sections")+" ",1),e[2]||(e[2]=t("svg",{class:"w-2.5 h-2.5 ms-2.5 transition-transform duration-200 group-hover:rotate-180",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})],-1))]),s.isOpen?(l(),a("div",R,[t("ul",U,[t("li",{onClick:e[1]||(e[1]=d=>i.selectSection(null)),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"}," Toutes les sections "),(l(!0),a(f,null,b(n.sections,d=>(l(),a("li",{key:d,onClick:h=>i.selectSection(d),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"},g(d),9,W))),128))])])):B("",!0)])}const G=_(q,[["render",E],["__scopeId","data-v-2c93503f"]]),H={props:{tags:{type:Array,required:!0}},data(){return{isOpen:!1}},methods:{toggleDropdown(){this.isOpen=!this.isOpen},selectTag(r){this.$emit("add-tag",r),this.isOpen=!1}}},J={class:"relative inline-flex group"},K={key:0,class:"absolute mt-[2ch] bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-neutral-800 dark:divide-neutral-700"},X={class:"py-2 text-sm text-gray-700 dark:text-neutral-400"},Y=["onClick"];function Z(r,e,n,p,s,i){return l(),a("div",J,[t("button",{onClick:e[0]||(e[0]=(...d)=>i.toggleDropdown&&i.toggleDropdown(...d)),class:"flex-shrink-0 z-10 inline-flex items-center text-white bg-gray-800 hover:bg-gray-900 focus:outline-none focus:ring-4 focus:ring-gray-300 font-medium rounded-lg text-sm px-5 py-2.5 me-2 mb-2 dark:bg-gray-800 dark:hover:bg-gray-700 dark:focus:ring-gray-700 dark:border-gray-70"},e[1]||(e[1]=[u(" Filtrer par sujet "),t("svg",{class:"w-2.5 h-2.5 ms-2.5 transition-transform duration-200 group-hover:rotate-180",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})],-1)])),s.isOpen?(l(),a("div",K,[t("ul",X,[(l(!0),a(f,null,b(n.tags,d=>(l(),a("li",{key:d,onClick:h=>i.selectTag(d),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"},g(d),9,Y))),128))])])):B("",!0)])}const $=_(H,[["render",Z],["__scopeId","data-v-dfdb1e6b"]]),ee={components:{ResetButton:V,SectionDropdown:G,TagDropdown:$},data(){return{hoveredBook:null,isDropdownOpen:!1,isTagDropdownOpen:!1,isSectionDropdownOpen:!1,selectedFilter:"Tout",selectedSection:null,searchQuery:"",matchAllTags:!0,minPages:0,maxPages:1e3,minPagesLimit:0,maxPagesLimit:1e3,allBooks:[],filteredBooks:[],filters:["Tout","Titre","Auteur","Éditeur","ISBN"],availableTags:[],selectedTags:[],availableSections:[]}},created(){this.allBooks=N.reduce((e,n)=>{var s,i;const p=((i=(s=n.isbn)==null?void 0:s.isbn13)==null?void 0:i.id)||n.title;return e.some(d=>{var h,o;return((o=(h=d.isbn)==null?void 0:h.isbn13)==null?void 0:o.id)===p})||e.push(n),e},[]);const r=this.allBooks.filter(e=>e.numberOfPages!==void 0);this.minPagesLimit=Math.min(...r.map(e=>e.numberOfPages)),this.maxPagesLimit=Math.max(...r.map(e=>e.numberOfPages)),this.minPages=this.minPagesLimit,this.maxPages=this.maxPagesLimit,this.filteredBooks=this.allBooks,this.filters=this.generateCriteria(),this.availableSections=this.generateSections(),this.availableTags=this.generateTags(),this.filters=this.generateCriteria(),this.availableSections=this.generateSections(),this.availableTags=this.generateTags()},methods:{showDetails(r){this.hoveredBook=r},hideDetails(){this.hoveredBook=null},addTag(r){this.selectedTags.includes(r)||(this.selectedTags.push(r),this.filterBooks())},removeTag(r){this.selectedTags=this.selectedTags.filter(e=>e!==r),this.filterBooks()},updateSection(r){this.selectedSection=r,this.filterBooks()},resetAllFilters(){this.searchQuery="",this.selectedFilter="Tout",this.selectedTags=[],this.selectedSection=null,this.minPages=this.minPagesLimit,this.maxPages=this.maxPagesLimit,this.filterBooks()},generateSections(){const r=this.allBooks.map(e=>e.section).filter(Boolean);return[...new Set(r)].sort()},toggleSectionDropdown(){this.isSectionDropdownOpen=!this.isSectionDropdownOpen},selectSection(r){this.selectedSection=r,this.isSectionDropdownOpen=!1,this.filterBooks()},generateCriteria(){var n;const r=this.allBooks[0],e=["Tout"];return r&&(r.title&&e.push("Titre"),(n=r.writer)!=null&&n.fullname&&e.push("Auteur"),r.editor&&e.push("Éditeur"),r.isbn&&e.push("ISBN")),e},generateTags(){const r=this.allBooks.flatMap(e=>e.tags||[]);return[...new Set(r)].sort()},normalizeString(r){return r.normalize("NFD").replace(/[\u0300-\u036f]/g,"")},toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen},toggleTagDropdown(){this.isTagDropdownOpen=!this.isTagDropdownOpen},selectFilter(r){this.selectedFilter=r,this.isDropdownOpen=!1,this.filterBooks()},addTag(r){this.selectedTags.includes(r)||this.selectedTags.push(r),this.isTagDropdownOpen=!1,this.filterBooks()},removeTag(r){this.selectedTags=this.selectedTags.filter(e=>e!==r),this.filterBooks()},filterBooks(){const r=this.normalizeString(this.searchQuery.toLowerCase());if(!r&&this.selectedTags.length===0&&!this.selectedSection){this.filteredBooks=this.allBooks;return}this.filteredBooks=this.allBooks.filter(e=>{var h,o,m,v,x,y,w,D,O,L;const n=c=>c&&this.normalizeString(c.toLowerCase()).includes(r),p=e.numberOfPages!==void 0&&e.numberOfPages>=this.minPages&&e.numberOfPages<=this.maxPages;let s=!0;switch(this.selectedFilter){case"Titre":s=n(e.title);break;case"Auteur":s=n((h=e.writer)==null?void 0:h.fullname);break;case"Éditeur":s=n(e.editor);break;case"ISBN":s=n((m=(o=e.isbn)==null?void 0:o.isbn13)==null?void 0:m.id)||n((x=(v=e.isbn)==null?void 0:v.isbn10)==null?void 0:x.id);break;case"Sujet":s=e.tags.some(c=>n(c));break;default:s=n(e.title)||n((y=e.writer)==null?void 0:y.fullname)||n(e.editor)||n((D=(w=e.isbn)==null?void 0:w.isbn13)==null?void 0:D.id)||n((L=(O=e.isbn)==null?void 0:O.isbn10)==null?void 0:L.id)||e.tags.some(c=>n(c))}const i=this.selectedTags.length===0||(this.matchAllTags?this.selectedTags.every(c=>e.tags.includes(c)):this.selectedTags.some(c=>e.tags.includes(c))),d=!this.selectedSection||e.section===this.selectedSection;return s&&i&&d&&p})}},watch:{allBooks(r){const e=r.filter(n=>n.numberOfPages!==void 0);this.minPagesLimit=Math.min(...e.map(n=>n.numberOfPages)),this.maxPagesLimit=Math.max(...e.map(n=>n.numberOfPages)),this.minPages=this.minPagesLimit,this.maxPages=this.maxPagesLimit,this.filterBooks()},matchAllTags(){this.filterBooks()}}},te={class:"w-full"},se={className:"grid grid-cols-6 grid-rows-5 gap-4"},re={className:"col-span-2 row-span-5  bg-gray-400 rounded-xl p-[1ch]"},oe={class:"mt-4"},ie=["onMouseover"],ne={className:"col-span-4 col-start-3 row-start-5  bg-gray-400 rounded-xl p-[1ch]"},le={class:"mt-4 flex flex-wrap gap-2"},ae=["onClick"],de={className:"col-span-4 col-start-3 row-start-1  bg-gray-400 rounded-xl p-[1ch]"},ge={class:"flex relative"},ue={key:0,id:"dropdown",class:"absolute z-10 mt-[2ch] bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700"},ce={class:"py-2 text-sm text-gray-700 dark:text-gray-200","aria-labelledby":"dropdown-button"},he=["onClick"],me={class:"relative w-full"},pe={className:"col-start-3 row-start-2  bg-gray-400 rounded-xl p-[1ch]"},fe={class:"relative inline-flex group"},be={class:"flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-gray-900 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700",type:"button"},ke={class:"absolute mt-[2ch] hidden group-hover:block transition-[opacity,transform] duration-300 transform opacity-0 group-hover:opacity-100 group-hover:translate-y-2 min-w-[11rem] bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-neutral-800 dark:divide-neutral-700"},ve={class:"py-2 text-sm text-gray-700 dark:text-neutral-400"},xe=["onClick"],ye={className:"col-start-4 row-start-2 col-span-2 bg-gray-400 rounded-xl p-[1ch]"},we={class:"mt-4"},_e={class:"block text-sm font-medium text-gray-700 dark:text-neutral-400 mb-2 center"},Te={class:"float-start font-black text-black"},Be={class:"float-end font-black text-black"},Pe={class:"relative"},Se={class:"relative h-2 bg-gray-300 dark:bg-neutral-700 rounded"},Ce=["min","max"],De=["min","max"],Oe={className:"col-start-6 row-start-2  bg-gray-400 rounded-xl p-[1ch]"},Le={class:"relative inline-flex group"},Fe={class:"absolute mt-[2ch] hidden group-hover:block transition-[opacity,transform] duration-300 transform opacity-0 group-hover:opacity-100 group-hover:translate-y-2 min-w-[11rem] bg-white divide-y divide-gray-100 rounded-lg shadow dark:bg-neutral-800 dark:divide-neutral-700"},Ne={class:"py-2 text-sm text-gray-700 dark:text-neutral-400"},ze=["onClick"],Ae={key:0,className:"col-start-6 row-start-2  bg-gray-400 rounded-xl p-[1ch]"},je={class:"block pt-[5ch]"},Ie={for:"toggle",class:"mr-2 text-sm font-medium text-gray-700"},Me={class:"font-bold"},Ve={className:"col-span-4 row-span-2 col-start-3 row-start-3  bg-gray-400 rounded-xl p-[1ch]"},qe={key:0},Qe={class:"text-3xl font-bold text-orange-500"},Re={key:1};function Ue(r,e,n,p,s,i){const d=C("router-link"),h=C("ResetButton");return l(),a("form",te,[t("div",se,[t("div",re,[t("ul",oe,[(l(!0),a(f,null,b(s.filteredBooks,o=>{var m,v,x,y;return l(),a("li",{key:(v=(m=o.isbn)==null?void 0:m.isbn13)==null?void 0:v.id,onMouseover:w=>i.showDetails(o),onMouseleave:e[0]||(e[0]=(...w)=>i.hideDetails&&i.hideDetails(...w)),class:"cursor-pointer font-black text-size-2xl"},[S(d,{to:`/book/${(y=(x=o.isbn)==null?void 0:x.isbn13)==null?void 0:y.id}`},{default:A(()=>[t("strong",null,g(o.title),1)]),_:2},1032,["to"])],40,ie)}),128))])]),t("div",ne,[S(h,{resetCallback:i.resetAllFilters},null,8,["resetCallback"]),t("div",le,[(l(!0),a(f,null,b(s.selectedTags,o=>(l(),a("div",{key:o,class:"flex items-center px-3 py-1 bg-gray-100 text-gray-800 dark:bg-neutral-800 dark:text-white rounded-full border border-gray-300 dark:border-neutral-700 shadow-sm"},[u(g(o)+" ",1),t("button",{onClick:k(m=>i.removeTag(o),["prevent"]),class:"ml-2 text-orange-500 hover:text-orange-700 dark:text-orange-400 dark:hover:text-orange-300"}," ✕ ",8,ae)]))),128))])]),t("div",de,[t("div",ge,[t("button",{id:"dropdown-button",onClick:e[1]||(e[1]=k((...o)=>i.toggleDropdown&&i.toggleDropdown(...o),["prevent"])),class:"flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-gray-900 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700",type:"button"},[u(g(s.selectedFilter||"Tout")+" ",1),e[10]||(e[10]=t("svg",{class:"w-2.5 h-2.5 ms-2.5","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})],-1))]),s.isDropdownOpen?(l(),a("div",ue,[t("ul",ce,[(l(!0),a(f,null,b(s.filters,o=>(l(),a("li",{key:o,onClick:k(m=>i.selectFilter(o),["prevent"]),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white cursor-pointer"},g(o),9,he))),128))])])):B("",!0),t("div",me,[T(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.searchQuery=o),onInput:e[3]||(e[3]=(...o)=>i.filterBooks&&i.filterBooks(...o)),type:"search",id:"search-dropdown",class:"block p-2.5 w-full z-20 text-sm text-gray-900 bg-gray-50 rounded-e-lg border-s-gray-50 border-s-2 border border-gray-300 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-s-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:border-blue-500",placeholder:"Rechercher...",required:""},null,544),[[P,s.searchQuery]])])])]),t("div",pe,[t("div",fe,[t("button",be,[u(g(s.selectedSection||"Toutes les sections")+" ",1),e[11]||(e[11]=t("svg",{class:"w-2.5 h-2.5 ms-2.5 transition-transform duration-200 group-hover:rotate-180","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})],-1))]),t("div",ke,[t("ul",ve,[t("li",{onClick:e[4]||(e[4]=k(o=>i.selectSection(null),["prevent"])),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"}," Toutes les sections "),(l(!0),a(f,null,b(s.availableSections,o=>(l(),a("li",{key:o,onClick:k(m=>i.selectSection(o),["prevent"]),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"},g(o),9,xe))),128))])])])]),t("div",ye,[e[13]||(e[13]=t("div",{class:"text-center font-black text-gray-900"}," nombre de pages min et maximum ",-1)),t("div",we,[t("label",_e,[t("span",Te,g(s.minPages),1),e[12]||(e[12]=u(" --- ")),t("span",Be,g(s.maxPages),1)]),t("div",Pe,[t("div",Se,[t("div",{class:"absolute h-2 bg-orange-500 rounded",style:F({left:`${s.minPages/s.maxPagesLimit*100}%`,width:`${(s.maxPages-s.minPages)/s.maxPagesLimit*100}%`})},null,4),T(t("input",{type:"range","onUpdate:modelValue":e[5]||(e[5]=o=>s.minPages=o),min:s.minPagesLimit,max:s.maxPagesLimit,class:"absolute w-full h-2 appearance-none pointer-events-auto slider-thumb",onInput:e[6]||(e[6]=(...o)=>i.filterBooks&&i.filterBooks(...o)),style:F({zIndex:s.minPages>s.maxPages-10?1:0})},null,44,Ce),[[P,s.minPages]]),T(t("input",{type:"range","onUpdate:modelValue":e[7]||(e[7]=o=>s.maxPages=o),min:s.minPagesLimit,max:s.maxPagesLimit,class:"absolute w-full h-2 appearance-none pointer-events-auto slider-thumb",onInput:e[8]||(e[8]=(...o)=>i.filterBooks&&i.filterBooks(...o))},null,40,De),[[P,s.maxPages]])])])])]),t("div",Oe,[t("div",Le,[e[14]||(e[14]=t("button",{class:"flex-shrink-0 z-10 inline-flex items-center py-2.5 px-4 text-sm font-medium text-gray-900 bg-gray-100 border border-gray-300 rounded-lg hover:bg-gray-200 dark:bg-neutral-800 dark:border-neutral-700 dark:text-white dark:hover:bg-neutral-700",type:"button"},[u(" Filtrer par sujet "),t("svg",{class:"w-2.5 h-2.5 ms-2.5 transition-transform duration-200 group-hover:rotate-180","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 10 6"},[t("path",{stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"m1 1 4 4 4-4"})])],-1)),t("div",Fe,[t("ul",Ne,[(l(!0),a(f,null,b(s.availableTags,o=>(l(),a("li",{key:o,onClick:k(m=>i.addTag(o),["prevent"]),class:"px-4 py-2 hover:bg-gray-100 dark:hover:bg-neutral-700 cursor-pointer"},g(o),9,ze))),128))])])])]),s.selectedTags.length>0?(l(),a("div",Ae,[e[16]||(e[16]=t("div",{class:"mt-4 flex items-center"},null,-1)),t("div",je,[t("label",Ie,[e[15]||(e[15]=u(" Filtrer par ")),t("span",Me,g(s.matchAllTags?"avec tout les sujets":"Parmis ces sujets"),1)]),T(t("input",{id:"toggle",type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=o=>s.matchAllTags=o),class:"toggle-checkbox"},null,512),[[z,s.matchAllTags]])])])):B("",!0),t("div",Ve,[s.hoveredBook?(l(),a("div",qe,[t("h2",Qe,g(s.hoveredBook.title),1),t("p",null,[e[17]||(e[17]=t("strong",null,"Auteur :",-1)),u(" "+g(s.hoveredBook.writer.fullname),1)]),t("p",null,[e[18]||(e[18]=t("strong",null,"Theme :",-1)),u(" "+g(s.hoveredBook.tags.join(", ")),1)]),t("p",null,[e[19]||(e[19]=t("strong",null,"Résumé :",-1)),u(" "+g(s.hoveredBook.description||"Non disponible"),1)])])):(l(),a("div",Re,e[20]||(e[20]=[t("p",{class:"text-gray-800 font-bold text-center text-2xl"},"Survolez un titre pour afficher ses détails ou cliquer sur le titre pour afficher la fiche complete.",-1)])))])])])}const We=_(ee,[["render",Ue],["__scopeId","data-v-e3d05695"]]),Ee={components:{BookSearch:We}},Ge={id:"search"};function He(r,e,n,p,s,i){const d=C("BookSearch");return l(),a("div",Ge,[S(d)])}const Xe=_(Ee,[["render",He]]);export{Xe as default};
